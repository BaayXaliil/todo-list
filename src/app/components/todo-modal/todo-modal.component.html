<h2 mat-dialog-title>{{ data.mode === 'create' ? 'Nouvelle tâche' : 'Modifier la tâche' }}</h2>

<form [formGroup]="form" (ngSubmit)="save()" class="todo-form">
	<mat-dialog-content>
		<div class="row">
			<mat-form-field appearance="outline">
				<mat-label>Titre</mat-label>
				<input matInput formControlName="titre" placeholder="Intitulé de la tâche">
				<mat-error *ngIf="form.get('titre')?.hasError('required')">Le titre est requis.</mat-error>
			</mat-form-field>

			<mat-form-field appearance="outline">
				<mat-label>Responsable</mat-label>
				<mat-select formControlName="personId">
					<mat-option *ngFor="let person of persons" [value]="person.id">{{ person.name }}</mat-option>
				</mat-select>
				<mat-error *ngIf="form.get('personId')?.hasError('required')">Sélectionne une personne.</mat-error>
			</mat-form-field>
		</div>

		<div class="row">
			<mat-form-field appearance="outline">
				<mat-label>Date de début</mat-label>
				<input matInput [matDatepicker]="startDatePicker" formControlName="startDate">
				<mat-datepicker-toggle matIconSuffix [for]="startDatePicker"></mat-datepicker-toggle>
				<mat-datepicker #startDatePicker></mat-datepicker>
				<mat-error *ngIf="form.get('startDate')?.hasError('required')">Indique une date de début.</mat-error>
			</mat-form-field>

			<mat-form-field appearance="outline">
				<mat-label>Date de fin</mat-label>
				<input matInput [matDatepicker]="endDatePicker" formControlName="endDate">
				<mat-datepicker-toggle matIconSuffix [for]="endDatePicker"></mat-datepicker-toggle>
				<mat-datepicker #endDatePicker></mat-datepicker>
			</mat-form-field>
		</div>

		<div class="row">
			<mat-form-field appearance="outline">
				<mat-label>Priorité</mat-label>
				<mat-select formControlName="priority">
					<mat-option *ngFor="let priority of priorities" [value]="priority">{{ priority }}</mat-option>
				</mat-select>
				<mat-error *ngIf="form.get('priority')?.hasError('required')">Choisis une priorité.</mat-error>
			</mat-form-field>

			<mat-form-field appearance="outline">
				<mat-label>Labels</mat-label>
				<mat-select formControlName="labels" multiple>
					<mat-option *ngFor="let label of labels" [value]="label">{{ label }}</mat-option>
				</mat-select>
			</mat-form-field>
		</div>

		<mat-form-field appearance="outline" class="full-width">
			<mat-label>Description</mat-label>
			<textarea matInput rows="4" formControlName="description" placeholder="Notes complémentaires"></textarea>
		</mat-form-field>
	</mat-dialog-content>

	<mat-dialog-actions align="end">
		<button mat-button type="button" (click)="cancel()" [disabled]="isSaving">Annuler</button>
		<button mat-flat-button color="primary" type="submit" [disabled]="isSaving">{{ isSaving ? 'Enregistrement…' : 'Enregistrer' }}</button>
	</mat-dialog-actions>
</form>
